<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catalogo+</title>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='apple-touch-icon.png') }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='favicon-32x32.png') }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='favicon-16x16.png') }}">
    <link rel="manifest" href="{{ url_for('static', filename='site.webmanifest') }}">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
        integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* body e mais */
        body {
            margin: 0;
            box-sizing: border-box;
            padding: 0;
        }

        p {
            margin: 0;
        }

        @font-face {
            font-family: 'Chetta';
            src: url("../static/fonts/chettavissto/ChettaVissto.woff");
            font-weight: normal;
            font-style: normal;
        }

        @font-face {
            font-family: 'Agenda';
            src: url("../static/fonts/agenda/agenda-light.ttf");
            font-weight: normal;
            font-style: normal;
        }

        @font-face {
            font-family: 'Agenda Bold';
            src: url("../static/fonts/agenda/agenda-bold.ttf");
            font-weight: normal;
            font-style: normal;
        }

        @font-face {
            font-family: 'Agenda Light';
            src: url("../static/fonts/agenda/agenda-light.ttf");
            font-weight: normal;
            font-style: normal;
        }

        /*  MAIN  */

        main {
            height: 100vh;
            background-image: url("../static/images/background.png");
            background-size: cover;
            background-position: center;
        }



        /* HEADER */

        .tit {
            font-family: 'Chetta';
            font-size: 30px;
            margin: 0;
            color: rgb(60, 60, 60);
            margin-top: 0px;
        }

        header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 40px;
            padding-top: 7px;
            padding-bottom: 5px;
            border-bottom: 2px solid rgb(60, 60, 60);
            backdrop-filter: blur(6px);
            background-color: rgba(255, 255, 255, 0.5);
        }

        header a {
            text-decoration: none;
            color: rgb(60, 60, 60);
            font-size: 25px;
            margin: 0px 10px 0px 10px;
        }


        /* FIRST CONTAINER */

        .first-container {
            width: 100%;
            display: flex;
            flex-direction: row;
            align-items: baseline;
            justify-content: center;
            margin-top: 2%;

        }

        /* FORM VISUALIZAR */

        form {
            margin-left: 2%;
            margin-right: 1%;
            display: flex;
            width: 46%;
            height: 100%;
            justify-content: space-between;
        }


        /* OPCOES */

        .opcoes-container {
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .titopc {
            font-family: 'Agenda Bold', 'Agenda';
            font-size: 18px;
            margin: 0;
        }

        .opcoes {
            margin-top: 2%;
            margin-left: 5%;

        }

        .opcoes label {
            margin-top: 2%;
            margin-bottom: 3%;
            font-size: 15px;
        }

        /* CHECKBOXS */


        .hidden {
            display: none;
        }



        .linha {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 20px;
            cursor: pointer;
            font-family: 'Agenda';
            color: rgb(60, 60, 60);
        }

        .opc {
            display: none;
        }

        .circle {
            width: 12px;
            height: 12px;
            border: 2px solid rgb(60, 60, 60);
            border-radius: 50%;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            transition: all .2s ease;
        }

        .opc:checked+.circle {
            background-color: rgb(60, 60, 60);
            box-shadow: inset 0 0 0 2px rgb(248, 228, 228);
        }


        /* CAPA INPUT */
        .input-capa {
            font-size: 10px;
            margin-top: 0px;
            margin-bottom: 0px;
            background-color: rgb(255, 255, 255);
            margin-left: 20%;
            border-radius: 8px;
            width: 40%;
            padding: 1%;
            border: 1px solid rgb(60, 60, 60) !important;
            color: rgb(60, 60, 60);
        }

        .input-capa:active {
            outline: none !important;
            box-shadow: none !important;
        }

        .input-capa:focus {
            outline: none !important;
            box-shadow: none !important;
            border: 1px solid rgb(60, 60, 60) !important;
        }

        #conteudo-opc a {
            font-size: 10px;
        }


        #conteudo-opc {
            display: none;
            flex-direction: column;
            align-items: baseline;
            gap: 5px;
        }

        #conteudo-opc input,
        #conteudo-opc a {
            opacity: 1;
            transition: .2s ease;
        }

        #conteudo-opc.disabled input,
        #conteudo-opc.disabled a {
            opacity: 0.4;
            pointer-events: none;
        }



        /* SELECT LOGO */
        #select-opcl {
            display: none;
            flex-direction: column;
        }

        #select-logo {
            font-size: 10px;
            background-color: rgb(255, 255, 255);
            margin-left: 10%;
            border-radius: 8px;
            width: 70%;
            padding: 2%;
            border: 1px solid rgb(60, 60, 60) !important;
            color: rgb(60, 60, 60);
        }

        #select-logo:active {
            border: 1px solid rgb(60, 60, 60) !important;
            outline: none !important;
            box-shadow: none !important;
        }

        #select-logo:focus {
            outline: none !important;
            box-shadow: none !important;
            border: 1px solid rgb(60, 60, 60);
        }

        /* SELECT SUBLOGO */


        #select-opcsl {
            display: none;
            flex-direction: column;
        }

        #select-sublogo {
            font-size: 10px;
            background-color: rgb(255, 255, 255);
            margin-left: 10%;
            border-radius: 8px;
            width: 70%;
            padding: 2%;
            border: 1px solid rgb(60, 60, 60) !important;
            color: rgb(60, 60, 60);
        }

        #select-sublogo:active {
            border: 1px solid rgb(60, 60, 60) !important;
            outline: none !important;
            box-shadow: none !important;
        }

        #select-sublogo:focus {
            outline: none !important;
            box-shadow: none !important;
            border: 1px solid rgb(60, 60, 60);
        }


        /* NOME DO ARQUIVO */
        .name-container {
            display: flex;
            flex-direction: column;
        }

        .name-container label {
            font-family: 'Agenda';
            font-size: 18px;
            margin-top: 2%;
        }

        .name-container input {
            border: 1px solid rgb(60, 60, 60);
            border-radius: 8px;
            padding: 2px;
            padding-left: 8px;
            margin-top: 2%;
            font-family: 'Agenda';
            font-size: 15px;

        }

        /* BUTTON CONTINUAR */
        .button-container {
            display: flex;
        }

        .button-container button {
            font-size: 13px;
            font-family: 'Agenda';
            font-weight: 700;
            color: white;
            border: none;
            background-color: rgba(40, 40, 40, 0.5);
            width: 100%;
            border-radius: 20px;
            padding: 5px 20px 5px 20px;
            margin-top: 5%;
            margin-left: auto;
        }




        /* IMAGEM EXEMPLO */

        .imgexemple-container {
            position: relative;
            width: 46%;
            margin-left: 1%;
            margin-right: 2%;

        }

        .imgexemple {
            background-image: url(/static/images/fotoexemplo.jpg);
            width: 90%;
            max-width: 100%;
            aspect-ratio: 9 / 16;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            font-size: 2vw;
            display: flex;
            flex-direction: column;
            align-items: baseline;
            color: rgb(255, 255, 255);
        }

        .imgexemple-sup {
            display: flex;
            width: 100%;
            flex-direction: column;
        }

        /* REFS */

        .refsup {
            margin: 2% 0px 0px 2%;
            font-size: 2.5em;
            font-family: 'Agenda';
        }

        .linharef {
            background-color: rgb(255, 255, 255);
            margin-left: 2%;
            width: 15%;
            height: 1px;

        }

        .nomeref {
            margin: 0px 0px 0px 2%;
            font-size: 1.2em;
            font-family: 'Agenda';
        }


        /* PREÇO DE */
        .preco {
            display: flex;
            flex-direction: column;

        }

        .dep {
            padding: 0;
            font-size: 1.8em;
            font-family: 'Agenda';
            margin: 1% 0px 0px 2%;
        }

        .de {
            display: flex;
            font-family: 'Agenda';
            margin-left: 2%;
        }

        .cifrao {
            font-size: 1.3em;
            margin: 2% 0px 0px 0px;
        }


        .precode {
            position: relative;
            font-size: 2.5em;
            display: inline-block;
            margin: 0;
        }

        .precode:after {
            content: "";
            position: absolute;
            top: 50%;
            left: 0;
            width: 100%;
            height: 0.1em;
            background: rgb(255, 0, 0);
            transform: rotate(-10deg);
        }


        /* PREÇO POR */

        .porp {
            font-size: 1.8em;
            font-family: 'Agenda';
            margin: 0px 0px 0px 2%;
        }

        .por {
            display: flex;
            font-family: 'Agenda';
            margin-left: 2%;
        }

        .precodepromo {
            position: relative;
            font-size: 2.5em;
            display: inline-block;
            margin: 0;
        }


        /* COMPOSIÇÃO */

        .imgexemple-inf {
            margin-top: auto;
            width: 100%;
        }

        .composicao {
            margin: 0px 0px 2% 2%;
            font-size: 0.8em;
        }

        .extit {
            font-family: 'Agenda';
        }


        /* SECOND CONTAINER */

        .second-container {
            width: 100%;
            display: flex;
            flex-direction: row;
            align-items: baseline;
            justify-content: center;
            margin-top: 2%;
            height: fit-content;
        }

        .imgcontracapa-container {
            margin-left: 2%;
            margin-right: 1%;
            display: flex;
            width: 46%;

        }

        .imgcapa-container {
            display: flex;
            width: 46%;
            margin-left: 1%;
            margin-right: 2%;
        }


        /* CAPA E CONTRACAPA */

        .imgcapa {
            width: 90%;
            max-width: 350px;
            aspect-ratio: 9 / 16;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            font-size: 1.5vw;
            flex-direction: column;
            align-items: baseline;
            position: relative;
            color: white;
            display: block;
            text-align: center;
        }



        .imgcontracapa {
            width: 90%;
            max-width: 350px;
            aspect-ratio: 9 / 16;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            font-size: 1.5vw;
            position: relative;
            color: white;
            display: block;
            text-align: center;
        }



        .imgcapa::after,
        .imgcontracapa::after {
            display: none;
        }

        .hidden {
            display: none;
        }

        .overlay {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.3);
            pointer-events: none;
            opacity: 0;
            transition: opacity .2s;
            z-index: 1;
        }

        .imgcapa.tem-imagem .overlay,
        .imgcontracapa.tem-imagem .overlay {
            opacity: 1;
        }



        /* LOGO e SUBLOGO capa */
        .imgcapa-container .logo {
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            margin: auto;
            width: 80%;
            height: 10%;
            position: relative;
            z-index: 2;
            display: none;
        }

        .imgcapa-container .sublogo {
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            margin-top: auto;
            width: 100%;
            height: 10%;
            position: absolute;
            bottom: 0;
            margin-bottom: 5%;
            z-index: 2;
            display: none;

        }

        /* LOGO E SUBLOGO CONTRACAPA */

        .imgcontracapa-container .logo {
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            width: 80%;
            height: 10%;
            position: relative;
            top: 40%;
            bottom: 40%;
            z-index: 2;
            display: none;
            margin-left: auto;
            margin-right: auto;
        }

        .imgcontracapa-container .sublogo {
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            width: 100%;
            height: 10%;
            position: relative;
            top: 40%;
            bottom: 40%;
            z-index: 2;
            display: none;
        }





        /* POPUP */

        #popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3;
        }

        .popup-div {
            display: flex;
            flex-direction: column;
            justify-content: center;
            border-radius: 25px;
            width: fit-content;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px 30px 15px 30px;
            border: 1px solid #ccc;
            z-index: 3;
        }

        .popup-div h3 {
            font-family: 'Agenda';
            margin-bottom: 0;
            margin-left: 10px;
        }

        #form-arquivo {
            display: flex;
            flex-direction: column;
        }

        .buttons {
            display: flex;
            gap: 3px;
        }

        .buttons button {
            font-size: 13px;
            font-family: 'Agenda';
            font-weight: 700;
            color: white;
            border: none;
            background-color: rgba(40, 40, 40, 0.5);
            width: 100%;
            border-radius: 20px;
            padding: 5px 20px 5px 20px;
            margin-top: 5%;
            margin-left: auto;
        }

        input {
            display: block;
            margin: 10px 0;
            border-radius: 8px;
            padding: 5px;
            width: 200px;
        }
    </style>
</head>

<body>
    <main>
        <header>
            <a href="/painel" class="fa-solid fa-arrow-left"></a>
            <p class="tit">Catálogo+</p>
            <a href="/" class="fa-regular fa-house"></a>
        </header>

        <div class="first-container">


            <!-- LADO SUPERIOR ESQUERDO -->
            <form action="/criarplanilha" method="post">

                <div class="opcoes-container">
                    <p class="titopc">Opcionais</p>
                    <div class="opcoes">

                        <label class="linha">
                            <input type="checkbox" class="opc" value="referencia" id="iptreferencia">
                            <span class="circle"></span>
                            Referência
                        </label>

                        <label class="linha">
                            <input type="checkbox" class="opc" value="preco" id="iptpreco">
                            <span class="circle"></span>
                            Preço
                        </label>

                        <label class="linha">
                            <input type="checkbox" class="opc" value="composicao" id="iptcomposicao">
                            <span class="circle"></span>
                            Composição
                        </label>

                        <label class="linha">
                            <input type="checkbox" class="opc" value="capa" id="check-opc">
                            <span class="circle"></span>
                            Capa
                        </label>

                        <div id="conteudo-opc" class="hidden">
                            <input id="input-capa" class="input-capa" type="text" placeholder="ex:A5001" disabled autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
                        </div>

                        <label class="linha">
                            <input type="checkbox" class="opc" value="contracapa" id="iptcontracapa">
                            <span class="circle"></span>
                            Contra-capa
                        </label>

                        <label class="linha">
                            <input type="checkbox" class="opc" value="logo" id="check-logo">
                            <span class="circle"></span>
                            Logo
                        </label>

                        <div id="select-opcl" class="hidden">
                            <select id="select-logo" disabled>
                                <option value="logo_anag">Ana Gonçalves</option>
                                <option value="logo_coerenza">Coerenza</option>
                                <option value="logo_coerenzaplus">Coerenza+</option>


                            </select>
                        </div>

                        <label class="linha">
                            <input type="checkbox" class="opc" value="logo" id="check-slogo">
                            <span class="circle"></span>
                            Sub-Logo
                        </label>

                        <div id="select-opcsl" class="hidden">
                            <select id="select-sublogo" disabled>
                                <option value="sublogo_golden">Golden</option>
                                <option value="sublogo_catarina">Catarina</option>

                            </select>
                        </div>

                    </div>


                    <div class="button-container">
                        <button type="submit" id="btn-continuar">Continuar</button>
                    </div>
                </div>
            </form>



            <!-- LADO SUPERIOR DIREITO -->
            <div class="imgexemple-container">
                <p class="extit">ex:</p>
                <div class="imgexemple">
                    <div class="imgexemple-sup">
                        <div class="referencia" style="display: none;">
                            <p class="refsup">V26022</p>
                            <div class="linharef"></div>
                            <p class="nomeref">Macacão V26022</p>
                        </div>

                        <div class="preco-container" style="display: none;">
                            <div class="preco">
                                <p class="dep">DE:</p>
                                <div class="de">
                                    <p class="cifrao">R$</p>
                                    <p class="precode">139,90</p>
                                    <!-- <p class="traco">/</p> -->
                                </div>
                            </div>

                            <div class="promo">
                                <p class="porp">POR:</p>
                                <div class="por">
                                    <p class="cifrao">R$</p>
                                    <p class="precodepromo">99,90</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="imgexemple-inf" style="display: none;">
                        <p class="composicao">96% POLIESTER 4% ELASTANO</p>
                    </div>

                </div>
            </div>


        </div>

        <!-- SEGUNDO CONTAINER -->

        <div class="second-container">


            <!-- LADO INFERIOR ESQUERDO -->
            <div class="imgcontracapa-container">
                <div class="imgcontracapa">
                    <div class="overlay"></div> <!-- Overlay separado -->
                    <div class="logo"></div>
                    <div class="sublogo"></div>
                </div>
            </div>


            <!-- LADO INFERIOR DIREITO -->
            <div class="imgcapa-container">
                <div class="imgcapa">
                    <div class="overlay"></div> <!-- Overlay separado -->
                    <div class="logo"></div>
                    <div class="sublogo"></div>
                </div>
            </div>
        </div>



    </main>
    <div id="popup" style="display: none;">
        <div class="popup-div">
            <h3>Nome do Arquivo</h3>

            <form id="form-arquivo" action="/gerar_planilha" method="post">
                <input type="text" id="nome-arquivo" name="nome_arquivo" required autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
                <input type="hidden" name="dados_json" id="dados-json">

                <div class="buttons">
                    <button type="button" onclick="fecharPopup()">Cancelar</button>
                    <button type="submit">Salvar</button>
                </div>

            </form>

        </div>
    </div>

    <script>
        // Variáveis globais
        const elementos = {
            // Inputs e checkboxes
            checkCapa: document.getElementById("check-opc"),
            checkLogo: document.getElementById("check-logo"),
            checkSublogo: document.getElementById("check-slogo"),
            checkReferencia: document.getElementById("iptreferencia"),
            checkPreco: document.getElementById("iptpreco"),
            checkComposicao: document.getElementById("iptcomposicao"),
            checkContracapa: document.getElementById("iptcontracapa"),

            // Containers e inputs
            conteudoCapa: document.getElementById("conteudo-opc"),
            inputCapa: document.getElementById("input-capa"),
            selectLogo: document.getElementById("select-logo"),
            selectSublogo: document.getElementById("select-sublogo"),
            boxSelectLogo: document.getElementById("select-opcl"),
            boxSelectSublogo: document.getElementById("select-opcsl"),

            // Divs de imagem
            capaDivs: [document.querySelector('.imgcapa'), document.querySelector('.imgcontracapa')],
            overlayDivs: document.querySelectorAll('.overlay'),
            logodivs: document.querySelectorAll('.logo'),
            sublogodivs: document.querySelectorAll('.sublogo'),


            refdiv: document.querySelector('.referencia'),
            precodiv: document.querySelector('.preco-container'),
            compdiv: document.querySelector('.imgexemple-inf'),

            // Popup
            popup: document.getElementById('popup'),
            formArquivo: document.getElementById('form-arquivo'),
            inputNomeArquivo: document.getElementById('nome-arquivo')
        };

        // Funções
        let timeoutId; // Para debounce

        function carregarImagem(ref) {
            if (!ref || ref.length < 2) {
                limparImagens();
                return;
            }

            const imagePath = `/foto/${ref}`;
            const testImage = new Image();

            testImage.onload = function () {

                elementos.capaDivs[0].style.backgroundImage = `url(${imagePath})`;
                elementos.capaDivs[0].classList.add('tem-imagem');
                elementos.overlayDivs[0].style.opacity = '1';


                if (elementos.checkContracapa.checked) {
                    elementos.capaDivs[1].style.backgroundImage = `url(${imagePath})`;
                    elementos.capaDivs[1].classList.add('tem-imagem');
                    elementos.overlayDivs[1].style.opacity = '1';
                }
            };

            testImage.onerror = function () {
                // Imagem não existe - limpar
                limparImagens();
            };

            testImage.src = imagePath;
        }

        function limparImagens() {
            elementos.capaDivs[0].style.backgroundImage = '';
            elementos.capaDivs[0].classList.remove('tem-imagem');
            elementos.overlayDivs[0].style.opacity = '0';

            if (!elementos.checkContracapa.checked) {
                elementos.capaDivs[1].style.backgroundImage = '';
                elementos.capaDivs[1].classList.remove('tem-imagem');
                elementos.overlayDivs[1].style.opacity = '0';
            }
        }

        function atualizarlogo() {
            const logo = elementos.selectLogo.value.trim();
            const logopath = `/static/logos/logo_${logo}.png`;

            elementos.logodivs.forEach(logodiv => {
                logodiv.style.backgroundImage = `url(${logopath})`;
            });
        }

        function atualizarSublogo() {
            const sublogo = elementos.selectSublogo.value.trim();
            const sublogopath = `/static/logos/sublogo_${sublogo}.png`;

            elementos.sublogodivs.forEach(sublogodiv => {
                sublogodiv.style.backgroundImage = `url(${sublogopath})`;
            });
        }

        //CHECKBOX CAPA
        elementos.checkCapa.addEventListener('change', () => {
            if (elementos.checkCapa.checked) {

                elementos.conteudoCapa.style.display = "flex";
                elementos.inputCapa.disabled = false;
                elementos.inputCapa.focus();

                if (elementos.inputCapa.value.trim()) {
                    carregarImagem(elementos.inputCapa.value.trim());
                }
            } else {

                elementos.conteudoCapa.style.display = "none";
                elementos.inputCapa.disabled = true;
                limparImagens();
            }
        });

        // BUSCA AUTOMÁTICA
        elementos.inputCapa.addEventListener('input', () => {
            clearTimeout(timeoutId);

            timeoutId = setTimeout(() => {
                const ref = elementos.inputCapa.value.trim();
                carregarImagem(ref);
            }, 500);
        });

        //CHECKBOX LOGO
        elementos.checkLogo.addEventListener("change", () => {
            if (elementos.checkLogo.checked) {
                atualizarlogo();
                elementos.boxSelectLogo.style.display = "flex";
                elementos.selectLogo.disabled = false;

                elementos.logodivs.forEach(logo => {
                    logo.style.display = "block";
                });
            } else {
                elementos.logodivs.forEach(logo => {
                    logo.style.display = "none";
                });

                elementos.boxSelectLogo.style.display = "none";
                elementos.selectLogo.disabled = true;
            }
        });

        elementos.selectLogo.addEventListener("change", atualizarlogo);

        //CHECKBOX SUBLOGO
        elementos.checkSublogo.addEventListener("change", () => {
            if (elementos.checkSublogo.checked) {
                atualizarSublogo();
                elementos.boxSelectSublogo.style.display = "flex";
                elementos.selectSublogo.disabled = false;

                elementos.sublogodivs.forEach(sublogo => {
                    sublogo.style.display = "block";
                });
            } else {
                elementos.sublogodivs.forEach(sublogo => {
                    sublogo.style.display = "none";
                });

                elementos.boxSelectSublogo.style.display = "none";
                elementos.selectSublogo.disabled = true;
            }
        });

        elementos.selectSublogo.addEventListener("change", atualizarSublogo);

        //CHECKBOX CONTRACAPA
        elementos.checkContracapa.addEventListener('change', () => {
            const ref = elementos.inputCapa.value.trim();

            if (elementos.checkContracapa.checked) {
                if (!ref) {
                    alert("Digite uma referência em Capa primeiro");
                    elementos.checkContracapa.checked = false;
                    return;
                }
                carregarImagem(ref);
            } else {
                elementos.capaDivs[1].style.backgroundImage = '';
                elementos.capaDivs[1].classList.remove('tem-imagem');
                elementos.overlayDivs[1].style.opacity = '0';
            }
        });

        //CHECKBOXES DO EXEMPLO
        elementos.checkReferencia.addEventListener('change', () => {
            elementos.refdiv.style.display = elementos.checkReferencia.checked ? "block" : "none";
        });

        elementos.checkPreco.addEventListener('change', () => {
            elementos.precodiv.style.display = elementos.checkPreco.checked ? "block" : "none";
        });

        elementos.checkComposicao.addEventListener('change', () => {
            elementos.compdiv.style.display = elementos.checkComposicao.checked ? "block" : "none";
        });

        // POPUP
        document.querySelector('form').addEventListener('submit', function (e) {
            e.preventDefault();
            abrirPopup();
        });

        function abrirPopup() {
            elementos.popup.style.display = 'flex';
            elementos.inputNomeArquivo.focus();
        }

        function fecharPopup() {
            elementos.popup.style.display = 'none';
            elementos.inputNomeArquivo.value = '';
        }

        elementos.popup.addEventListener('click', function (e) {
            if (e.target === elementos.popup) {
                fecharPopup();
            }
        });

        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape' && elementos.popup.style.display === 'flex') {
                fecharPopup();
            }
        });

        elementos.formArquivo.addEventListener('submit', function (e) {

            if (!elementos.inputNomeArquivo.value.trim()) {
                alert('Digite um nome para o arquivo');
                e.preventDefault();
                return;
            }

            const dadosParaSalvar = {
                nomeArquivo: elementos.inputNomeArquivo.value,
                referencia: elementos.checkReferencia.checked,
                preco: elementos.checkPreco.checked,
                composicao: elementos.checkComposicao.checked,
                capa: elementos.checkCapa.checked,
                contracapa: elementos.checkContracapa.checked,
                logo: elementos.checkLogo.checked,
                sublogo: elementos.checkSublogo.checked,
                referenciaCapa: elementos.inputCapa.value,
                logoescolhida: elementos.selectLogo.value,
                sublogoescolhida: elementos.selectSublogo.value
            };

            document.getElementById("dados-json").value = JSON.stringify(dadosParaSalvar);
        });

        document.querySelector('#form-arquivo button[type="button"]').addEventListener('click', fecharPopup);

    </script>
</body>

</html>